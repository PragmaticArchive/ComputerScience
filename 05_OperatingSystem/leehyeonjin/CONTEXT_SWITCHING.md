# PCB, 컨텍스트 스위치, 커널

---

### PCB(Process Control Block)

**Process Management**

CPU의 프로세스가 여러개일때, CPU 스케줄링을 통해 관리하는 것.

이때, CPU는 각 프로세스들이 누군지 알아야 관리 가능.

프로세스들의 특징을 가지고 있는 것이 바로 Process Metadata.

- Process ID
- Process State
- Process Priority
- CPU Registers
- Owner
- CPU Usage
- Memory Usage

이 메타데이터는 프로세스가 생성되면 PCB에 저장됨.
</br></br>

**PCB(Process Control Block)**

프로세스 메타 데이터들을 저장해 놓은 곳, 한 PCB 안에는 하나의 프로세스 정보가 저장됨.

프로세스 생성시 만들어지며, CPU의 주기억장치에서 유지됨.

> 💡 **프로그램 실행 시**
>
> 프로그램 실행 → 프로세스 생성 → 프로세스 주소 공간에 (코드, 데이터, 스택) 생성 → 이 프로세스의 메타데이터들이 PCB에 저장됨.

---

### 컨텍스트 스위치

**PCB의 필요성**

CPU에서는 프로세스의 상태에 따라 교체작업이 이루어짐.

Ex. 인터럽트가 발생해서 할당받은 프로세스가 waiting 상태가 되고, 다른 프로세스를 running 상태로 바꿔 올릴때.

이때, 앞으로 다시 수행할 대기 중인 프로세스에 관한 저장값을 PCB에 저장 가능.
</br></br>

**Context Switching**

CPU가 이전의 프로세스 상태를 PCB에 보관하고, 또 다른 프로세스의 정보를 PCB에 읽어 레지스터에 적재하는 과정.

⇒ 멀티 프로세스 / 멀티 스레드 가능.

보통 인터럽트가 발생하거나, 실행 중인 CPU 사용 허가시간을 모두 소모하거나 입출력을 위해 대기해야 하는 경우에 컨텍스트 스위치 발생.

> 💡 **스레드와 프로세스의 컨텍스트 스위치**
>
> 프로세스를 새로 생성하거나 제거하는 것이 스레드를 생성하거나 제거하는 것에 비해 오래 걸림.
> ⇒ 프로세스 간의 컨텍스트 스위칭이 스레드 간의 컨텍스트 스위칭보다 오래걸림.

---

### 커널(Kernel)

하드웨어 - 응용 프로그램 사이의 인터페이스 제공, 컴퓨터 자원 관리.

**User, Kernel 스레드**

1. 커널 레벨(Kernel Level) :

- 프로그래머 요청에 따라 스레드를 생성하고 스케줄링하는 주체가 커널이면 커널 레벨(Kernel Level) 스레드.
- 장점 : 커널이 직접 제공해 주기 때문에 안정성, 다양한 기능이 제공됨.
- 단점 : 유저 모드에서 커널 모드로의 전환이 빈번하게 이뤄져 성능저하 발생.

2. 유저 레벨(User Level) :

- 커널에 의존적이지 않은 형태로 스레드의 기능을 제공하는 라이브러리 활용.
- 장점 : 모드 간의 전환이 없어 성능 이득 발생.
- 단점 : 하나의 스레드가 커널에 의해 블로킹 되면 프로세스 전체가 블로킹되고, 이를 해결하려면 프로그래밍이 어려워지고 커널 레벨 스레드에 비해 결과 예측이 어려워짐.
