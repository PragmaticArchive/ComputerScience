# 교착상태

---

### 교착상태(DeadLock)

두개 이상의 프로세스나 스레드가 서로 자원을 얻지 못해서 다음 처리를 하지 못하는 상태.

무한히 다음 자원을 기다리게 되는 상태.

서로 원하는 자원이 상대방에 할당되어 무한정 wait 상태에 빠지는 것.

---

### 교착상태 발생조건 4가지

4가지 모두 성립해야 교착상태 발생.
</br></br>

**1. 상호배제(Mutual Exclusion)**

자원은 한번에 한 프로세스만 이용 가능.
</br></br>

**2. 점유 대기(Hold and Wait)**

최소한 하나의 자원을 점유하고 있으면서 다른 프로세스에 할당되어 사용중인 자원을 추가로 점유하기 위해 대기하는 프로세스가 존재해야 함.
</br></br>

**3. 비선점(Nopreemption)**

다른 프로세스에 할당된 자원은 사용이 끝날 때까지 강제로 빼앗길 수 없음.
</br></br>

**4. 순환 대기(Circular Wait)**

프로세스의 집합에서 순환 형태로 자원을 대기하고 있어야 함.

---

### 교착상태 해결방안

**1. 예방(prevention)**

교착 상태 발생 조건 중 하나를 제거하면서 해결.

- 상호배제 부정 : 여러 프로세스가 공유자원 사용.
- 점유대기 부정 : 프로세스 실행전 모든 자원을 할당.
- 비선점 부정 : 자원 점유중인 프로세스가 다른 자원을 요구할 때 가진 자원을 반납.
- 순환대기 부정 : 자원에 고유번호 할당후, 순서대로 자원 요구.

자원낭비가 매우 심함.
</br></br>

**2. 회피(avoidance)**

교착 상태 발생시 피해나가는 방법.

- 은행원 알고리즘 : 프로세스가 자원을 요구할 때, 시스템은 자원을 할당한 후에도 안정 상태로 남아있게 되는지 사전에 검사하여 안정 상태면 할당, 아니면 다른 프로세스들이 자원을 해제할 때까지 대기.
- 자원 할당 그래프 알고리즘 : 프로세스가 자원을 요구하면 요청 간선을 할당 간선으로 변경할 경우, 사이클(순환대기)이 생성되는지 확인하여, 사이클을 생성하지 않는 경우 자원 할당.
</br></br>

**3. 탐지(detection) & 회복(recovery)**

탐지 : 교착상태가 발생했다는 것을 발견 → 회복 : 사용자 처리, 시스템 처리.

사용자 처리 :

- 교착상태에 있는 프로세스 중 하나를 사용자가 강제 종료 시킴.

시스템 처리 :

- 프로세스 중지 : 교착상태의 모든 프로세스 중지 or 교착상태가 해결될 때까지 한 프로세스씩 중지.
- 자원선점 : 프로세스들로부터 자원을 빼앗아 교착상태가 해결될 때까지 다른 프로세스들에 자원을 할당.
